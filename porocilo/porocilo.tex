\documentclass[11pt,a4paper]{article}

\usepackage[slovene]{babel}
\usepackage[utf8x]{inputenc}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{rotating}
\usepackage{adjustbox}
\usepackage{animate}

\pagestyle{plain}

\begin{document}
\title{Poročilo pri predmetu \\
Analiza podatkov s programom R}
\author{Samo Metličar}
\maketitle

\section{Izbira teme}

Za temo sem izbral McDonald's, obravnaval pa bom njihovo ponudbo, raz\-šir\-je\-nost ter delovanje podjetja samega.

\section{Obdelava, uvoz in čiščenje podatkov}

Iz \href{http://nutrition.mcdonalds.com/getnutrition/nutritionfacts.pdf}{McDonalds Nutrition Facts} sem dobil prvo tabelo, ki vsebuje hranilne vrednosti njihovih jedi. Datoteka je bila v PDF formatu ter večina imen je bila več-vrstičnih, kar je povzročalu probleme tako Excelu kot Wordu. Ko sem prenesel vse podatke v Excel, sem shranil tabelo kot CSV datoteko v \verb|podatki/nutrition.csv|. Nato sem se lotil druge tabele, ki sem jo pridobil iz \href{http://nutrition.mcdonalds.com/getnutrition/ingredientslist.pdf}{McDonalds Ingredient List}. Ta tabela mi je povzročala malce več težav in po predlogu asistenta sem se odločil, da jo bom pretvoril v \verb|TRUE/FALSE| tabelo, kar sem storil s pomocjo R. Ker pa se vecina jedi ne pojavla pogosto, sem moral močno zožiti izbor jedi, zato je tabela manjših razsegov. \par

Obe tabeli sem uvozil s funkcijama v \verb|uvoz/uvoz.r| ter ju na to s funkcijami v \verb|lib/tabeli.r| še dopolnil ter pretvoril v željeni tabeli. Sledilo je ustvarjanje grafov s pomočjo funkcij v \verb|lib/graf1.r|, ki izriše vse tri grafe v PDF dokument \verb|slike/grafi.pdf|. \par

Na koncu je sledil še uvoz podatkov iz Wikipedije, kjer sem dobil podatke o državah, kjer McDonalds obratuje itd. Po uvozu teh podatkov sem še nekoliko uredil tabelo ter spremenil nekatere vrednosti. Na koncu pa sem še pretvoril datume iz niza v \verb|Date| ter jih izpisal v nam bolj prijazni oblik.

\includegraphics[width=\textwidth]{../slike/graf1.pdf}
\includegraphics[width=\textwidth]{../slike/graf2.pdf}
\includegraphics[width=\textwidth]{../slike/graf3.pdf}

\newpage

\section{Podatki}

V tem razdelku bom predstavil podatke oz. tabele, ki sem jih uporabljal pri izdelovanju projekta ter tudi pokazal skrčene verzije le-teh.

\subsection{Tabela - lokacije}
\includegraphics[width=\textwidth]{../slike/tabela_lokacije.pdf}

Prikazana tabela prikazuje prvih 40 vrstic tabele, ki je bila uvožena iz Wikipedije. Na njej lahko vidimo, da ima v row.names zabeležene države, v drugem stolpcu so mesta, kjer se
je McDonalds v tisti državi prvotno odprl, v četrtem stolpcu pa še datum le-tega odprtja. Tretji stolpec prikazuje število trenutno obratujočih McDonaldsov v državi. \par

Tabela je urejena po datumih, ki pa so zapisani v nam domači obliki. Pravtako tretji stolpec prvotno niso bila le števila, temveč kakšni znaki ter tudi besede, ki pa sem jih nato odstranil.

\subsection{Tabela - hranilne vrednosti}
\includegraphics[width=\textwidth]{../slike/tabela_nutrition.pdf}

Prikazana tabela je del tabele, ki sem jo uporabil za pridobitev vseh potrebnih podatkov o hranilnih vrednostih jedi, ki jih nudijo. Tukaj prikazujem le prvih 30 jedi ter samo prve in zadnje 3 stolpce, medtem ko je prvotna tabela hranilnih vrednosti dimenzij $54\times24$, izpuščeni stolpci pa so vsi številske vrednosti raznih hranilnih vrednosti jedi. \par

Zadnji stolpec prikazuje razvrstitev v eno izmed kategorij: $$\mbox{najmanjše} < \mbox{nizko} < \mbox{srednje} < \mbox{visoko} < \mbox{največje}$$
Tukaj gre za urejenostno spremenljivko. Kategorija je dodeljena glede na razmerje med kalorijami jedi ter velikostjo njene porcije v gramih.
Prvi stolpec vsebuje imenske spremenljivke, preostali pa številske.

\subsection{Tabela - sestavine}
\includegraphics[width=\textwidth]{../slike/tabela_sestavine.pdf}

Zadnja tabela je skrčitev tabele o sestavinah jedi. Prvotna tabela je dimenzij $16 \times 9$, kjer so male dimenzije posledica izbire tabele. Ker so skupne sestavine jedi precej redke, sem moral izbrati takšne jedi in sestavine, ki imajo vsaj nekaj skupnih elementov. Tako prvi stolpec prikazuje ime jedi, predzadnji število sestavin, ki so v tabeli in jih jed vsebuje, zadnji stolpec pa je urejenostna spremenljivka glede na predzadnji stolpec in lahko zasede vrednosti: $$\mbox{podpovprečno} < \mbox{povprečno} < \mbox{nadpovprečno}$$
Ostali stolpci zavzemajo vrednosti \verb|TRUE/FALSE|, glede na to, če vsebuje jed le-to sestavino ali ne.

\newpage

\section{Analiza in vizualizacija podatkov}


V tretji fazi sem uvozil zemljevid sveta s spletne strani \href{http://www.naturalearthdata.com/http//www.naturalearthdata.com/download/50m/cultural/ne_50m_admin_0_countries.zip}{Natural Earth Data}, ki jo je svetoval asistent ter se lotil spreminjanja tabel, ki so mi bile na voljo, da so ustrezale le-temu zemljevidu. V \verb|lib/uvozi.zemljevid.r| najdemo program, ki nam uvozi le-tega. \par

Nato pa sem program \verb|vizualizacija/vizualizacija.r| spremenil ter dodelal, da shrani zemljevid s spleta ter ga preuredi v dva zemljevida. Prvi prikazuje, koliko McDonaldsov je v posameznih državah po svetu, drugi pa kdaj je bila odprta prva restavracija v tisti državi.

Prvo sem se lotil števila restavracij po državah, tako da sem popravil ter uskladil imena z zemljevida ter mojih podatkov, da sta se ujemala v številu držav, kot tudi katere sta vsebovala. Nato pa sem izrisal graf s funkcijo \verb|spplot|. \par

Za drug zemljevid sem podatke uredil po datumih ter jim po desetletjih dodelil barve, po letnicah znotraj desetletja pa \verb|transparency|. Nato pa sem želel dodati še imena nekaterih največjih držav, kjer McDonalds posluje ter jih tudi označiti, zato sem na spletu poiskal \href{https://developers.google.com/public-data/docs/canonical/countries_csv}{koordinate središč držav} ter \href{http://simple.wikipedia.org/wiki/List_of_countries_by_area}{njihove površine}. Oba seznama sem pretvoril ter naložil, kot \verb|.CSV| datoteki ter ju uvozil v moj program. Podatke sem uredil, tako da so se ujemali s seznamom držav iz zemljevida ter prejšnjimi podatki ter ustvaril seznam imen ter koordinat, ki sem jih želel izpisati. Za največje države sem izpisal celotno ime, medtem ko sem za manjše izpisal kratico ali pa jo samo označil s krogcem. Zemljevid sem nato izrisal v \verb|.PDF| obliki. \par

V tej fazi mi povzroča probleme predvsem \verb|spplot|, ki ga ne želi zapisati v \verb|.PDF|, razen če se še posebaj zaženejo tiste vrstice. \newpage

\begin{sidewaysfigure}[ht]
	\includegraphics[width=\textwidth]{../slike/zemljevid1.pdf}
\end{sidewaysfigure}


\begin{sidewaysfigure}[ht]
	\includegraphics[width=\textwidth]{../slike/zemljevid2.pdf}
\end{sidewaysfigure}

\newpage

\section{Napredna analiza podatkov}

\begin{center}
\animategraphics[controls, loop, width=1.2\linewidth]{1}{../slike/animacija}{}{}
\end{center}

\end{document}
